import{d as N,r,a as R,o as i,c,b as e,t as n,w as D,e as f,v,f as _,u as g,I as k,g as l,h as B,i as A,j as $}from"./main-BZ_6efUG.js";const q={class:"max-w-2xl mx-auto p-4"},H=e("h1",{class:"text-3xl font-bold mb-6 dark:text-white"},"Your Account",-1),L={class:"text-lg mb-4 dark:text-gray-300"},F={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6 mb-6"},I=e("h2",{class:"text-xl font-semibold mb-4 dark:text-white flex items-center"},[e("i",{class:"fas fa-lock mr-2"}),l(" Update Password ")],-1),O={class:"pl-3"},Y=e("div",{class:"hidden"},[e("label",{for:"username"},"Username"),e("input",{type:"text",id:"username",autocomplete:"username"})],-1),G={class:"mb-4 relative"},J=e("label",{for:"currentPassword",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Current Password",-1),K={class:"relative"},Q=["type"],W={class:"mb-4 relative"},X=e("label",{for:"newPassword",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"New Password",-1),Z={class:"relative"},ee=["type"],te={class:"mb-4 relative"},se=e("label",{for:"confirmPassword",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Confirm",-1),oe={class:"relative"},re=["type"],ae=e("button",{type:"submit",class:"w-full bg-brand-500 hover:bg-brand-600 text-white font-bold py-2 px-4 rounded flex items-center justify-center"},[e("i",{class:"fas fa-save mr-2"}),l(" Update Password ")],-1),ne={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},le=e("h2",{class:"text-xl font-semibold mb-4 dark:text-white flex items-center"},[e("i",{class:"fas fa-exclamation-triangle text-red-500 mr-2"}),e("span",{class:"flex-1"},"Delete Account")],-1),de={class:"pl-3"},ie=$('<p class="mb-4 dark:text-gray-300">Please be advised:</p><ul class="list-disc list-inside mb-4 dark:text-gray-300"><li><span class="font-bold">Secrets will remain active until they expire.</span></li><li>Any secrets you wish to remove, <a href="#" class="underline">burn them before continuing</a>.</li><li>Deleting your account is <span class="italic">permanent and non-reversible.</span></li></ul>',2),ce=e("i",{class:"fas fa-trash-alt mr-2"},null,-1),ue={class:"text-sm text-gray-500 dark:text-gray-400 mt-2"},pe={class:"mt-6 text-sm text-gray-600 dark:text-gray-400"},me={class:"text-sm text-gray-600 dark:text-gray-400"},fe=e("span",{class:"font-semibold"},"contributor",-1),ge={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},he={class:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg"},ye=e("h3",{class:"text-xl font-bold mb-4 text-gray-900 dark:text-white"},"Confirm Account Deletion",-1),we=e("p",{class:"mb-4 text-gray-700 dark:text-gray-300"},"Are you sure you want to permanently delete your account? This action cannot be undone.",-1),be=e("input",{type:"hidden",name:"tabindex",value:"destroy"},null,-1),xe={class:"mb-4"},ve={key:0,class:"text-red-500 mb-4"},_e={class:"flex justify-end space-x-4"},ke=["disabled"],Pe={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Ce=e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),De=e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),Ae=[Ce,De],Ve={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor"},Se=e("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1),Me=[Se],je=N({__name:"Account",setup(Ue){const V=window.custid,S=r("Agency"),M=r(796),U=r("Dec 03, 2011"),T=r("2013-02-20"),h=r(""),y=r(""),w=r(""),a=R({current:!1,new:!1,confirm:!1}),u=r(!1),p=r(""),d=r(!1),m=r(""),j=async()=>{d.value=!0,m.value="";try{const s=new URLSearchParams;s.append("confirmation",p.value);const t=await fetch("/api/v1/account/destroy",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:s.toString()});if(!t.ok){const x=(await t.json()).message;throw new Error(x||"Failed to delete account")}u.value=!1,window.location.href="/"}catch(s){s instanceof Error?m.value=s.message||"An error occurred while deleting the account":console.error("An unexpected error occurred",s)}finally{d.value=!1}},P=r(!1),C=r(""),E=r(""),z=async()=>{P.value=!0,C.value="";try{const s=new URLSearchParams;s.append("newp",y.value),s.append("newp2",w.value),s.append("currentp",h.value);const t=await fetch("/api/v1/account/change-password",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:s.toString()});if(!t.ok){const x=(await t.json()).message;throw new Error(x||"Failed to update password")}window.location.href="/account",E.value="Password updated successfully."}catch(s){s instanceof Error?C.value=s.message||"An error occurred while updating the password":console.error("An unexpected error occurred",s)}finally{P.value=!1}},b=s=>{a[s]=!a[s]};return(s,t)=>(i(),c("div",q,[H,e("p",L,"Account type: "+n(S.value),1),e("div",F,[I,e("div",O,[e("form",{onSubmit:D(z,["prevent"])},[Y,e("div",G,[J,e("div",K,[f(e("input",{type:a.current?"text":"password",id:"currentPassword","onUpdate:modelValue":t[0]||(t[0]=o=>h.value=o),required:"",autocomplete:"current-password",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-brand-500 focus:ring focus:ring-brand-500 focus:ring-opacity-50 dark:bg-gray-700 dark:text-white pr-10"},null,8,Q),[[v,h.value]]),e("button",{type:"button",onClick:t[1]||(t[1]=o=>b("current")),class:"absolute inset-y-0 right-0 pr-3 flex items-center"},[_(g(k),{icon:a.current?"heroicons-solid:eye":"heroicons-outline:eye-off",class:"h-5 w-5 text-gray-400 dark:text-gray-100","aria-hidden":"true"},null,8,["icon"])])])]),e("div",W,[X,e("div",Z,[f(e("input",{type:a.new?"text":"password",id:"newPassword","onUpdate:modelValue":t[2]||(t[2]=o=>y.value=o),required:"",autocomplete:"new-password",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-brand-500 focus:ring focus:ring-brand-500 focus:ring-opacity-50 dark:bg-gray-700 dark:text-white pr-10"},null,8,ee),[[v,y.value]]),e("button",{type:"button",onClick:t[3]||(t[3]=o=>b("new")),class:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:text-gray-300 dark:hover:text-gray-100"},[_(g(k),{icon:a.new?"heroicons-solid:eye":"heroicons-outline:eye-off",class:"h-5 w-5 text-gray-400 dark:text-gray-100","aria-hidden":"true"},null,8,["icon"])])])]),e("div",te,[se,e("div",oe,[f(e("input",{type:a.confirm?"text":"password",id:"confirmPassword","onUpdate:modelValue":t[4]||(t[4]=o=>w.value=o),required:"",autocomplete:"confirm-password",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-brand-500 focus:ring focus:ring-brand-500 focus:ring-opacity-50 dark:bg-gray-700 dark:text-white pr-10"},null,8,re),[[v,w.value]]),e("button",{type:"button",onClick:t[5]||(t[5]=o=>b("confirm")),class:"absolute inset-y-0 right-0 pr-3 flex items-center"},[_(g(k),{icon:a.confirm?"heroicons-solid:eye":"heroicons-outline:eye-off",class:"h-5 w-5 text-gray-400 dark:text-gray-100","aria-hidden":"true"},null,8,["icon"])])])]),ae],32)])]),e("div",ne,[le,e("div",de,[ie,e("button",{onClick:t[6]||(t[6]=o=>u.value=!0),class:"w-full bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded flex items-center justify-center"},[ce,l(" Permanently Delete Account ")]),e("p",ue,"Deleting "+n(g(V)),1)])]),e("p",pe," Created "+n(M.value)+" secrets since "+n(U.value)+". ",1),e("p",me,[l(" You became a "),fe,l(" on "+n(T.value)+". ",1)]),u.value?(i(),c("div",ge,[e("form",{onSubmit:D(j,["prevent"]),class:"w-full max-w-md"},[e("div",he,[ye,we,be,e("div",xe,[f(e("input",{"onUpdate:modelValue":t[7]||(t[7]=o=>p.value=o),type:"password",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",autocomplete:"confirmation",placeholder:"Confirm with your password"},null,512),[[B,p.value]])]),m.value?(i(),c("p",ve,n(m.value),1)):A("",!0),e("div",_e,[e("button",{onClick:t[8]||(t[8]=o=>u.value=!1),type:"button",class:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-400 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"}," Cancel "),e("button",{type:"submit",disabled:!p.value||d.value,class:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 dark:bg-red-700 dark:hover:bg-red-800 flex items-center disabled:opacity-50 disabled:cursor-not-allowed"},[d.value?(i(),c("svg",Pe,Ae)):(i(),c("svg",Ve,Me)),l(" "+n(d.value?"Deleting...":"Delete Account"),1)],8,ke)])])],32)])):A("",!0)]))}});export{je as default};
